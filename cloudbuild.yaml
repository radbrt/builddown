  
steps:
- name: 'gcr.io/cloud-builders/docker'
  args: [ 'build', '-t', 'gcr.io/$PROJECT_ID/github.com/radbrt/builddown:$SHORT_SHA', '-t', 'gcr.io/$PROJECT_ID/github.com/radbrt/builddown:latest', '.' ]
  timeout: 3600s
- name: 'gcr.io/$PROJECT_ID/github.com/radbrt/builddown:$SHORT_SHA'
  args: ['R', '-e', '"knitr::knit(\"article.Rmd\")"']

artifacts:
  objects:
    location: 'gs://com_radbrt_builddown/'
    paths: ['article.pdf']


images:
  - 'gcr.io/$PROJECT_ID/github.com/radbrt/builddown:$SHORT_SHA'
  - 'gcr.io/$PROJECT_ID/github.com/radbrt/builddown:latest'

options:
  machinetype: n2d-standard-4

tags:
  - "buildarticle"
